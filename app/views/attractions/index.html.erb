<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
<script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBYsbaTUCmS5U25KSWi21-C-Xgk5K7LwIU">
</script>

<nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1><%= image_tag("PSAC_PremierAttractions-logo.jpg") %><a href="#">Map of Seattle's Premier Attractions</a></h1>
    </li>
     <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <!-- Right Nav Section -->
    <ul class="right">
      <li class="active"><a href="#">Right Button Active</a></li>
      <li class="has-dropdown">
        <a href="#">Right Button Dropdown</a>
        <ul class="dropdown">
          <li><a href="#">First link in dropdown</a></li>
          <li class="active"><a href="#">Active link in dropdown</a></li>
        </ul>
      </li>
    </ul>

    <!-- Left Nav Section -->
    <ul class="left">
      <li><a href="#">Left Nav Button</a></li>
    </ul>
  </section>
</nav>
<div class="row">
  <div class="columns large-10">
    <div>
      <div id="map" class="google-maps"></div>
    </div>
  </div>
  <div id="attraction_sidebar" class="columns small-2">
    <%= form_tag attractions_path, method: 'get' do %>
      <%= select_tag('location', options_from_collection_for_select(@locations, :id, :name, params[:location]), include_blank: true, onchange: 'this.form.submit()') %>
      <%= submit_tag 'submit', id: 'submit_location' %>
      <%= javascript_tag "$('#submit_location').hide()" %>
    <% end %>

    <table>
      <tbody>
        <% @attractions.each do |attraction| %>
          <tr>
            <td><%= attraction.name %></td>
            <td><%= attraction.address %></td>
            <td><%= link_to 'Show', attraction %></td>
            <td><%= link_to 'Edit', edit_attraction_path(attraction) %></td>
            <td><%= link_to 'New', new_attraction_path %></td>
            <td><%= link_to 'Destroy', attraction, method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<script type="text/javascript">
handler = Gmaps.build('Google');
handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  markers = handler.addMarkers(<%= raw @markers_hash.to_json %>, {draggable: false});
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  handler.getMap().setZoom(13);
  handler.getMap().setCenter({lat: 47.618615, lng: -122.338470})
});
</script>
